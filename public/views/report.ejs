<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WV DoT Bridge Inspection - Report</title>
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/styles.min.css">
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <link rel="stylesheet" href="/resources/demos/style.css">
</head>

<body id="Header_Body" style="background: #e6ecf0">
    <nav class="navbar navbar-light navbar-expand-md sticky-top">
        <div id="nav" class="container">
            <a class="navbar-brand" href="#">WV Bridge Inspection Tool</a>
            <button class="navbar-toggler" data-toggle="collapse" data-target="#navcol-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navcol-1">
                <ul class="nav navbar-nav ml-auto">
                    <%if (userinfo) { %>
                        <li class="nav-item" role="presentation">
                            <a class="nav-link" href="/buffer">My Images
                            </a>
                        </li>
                        <li class="nav-item" role="presentation">
                            <a class="nav-link" href="/user">Logged in as
                                <%- JSON.parse(userinfo).userName %>
                            </a>
                        </li>
                        <li class="nav-item" role="presentation">
                            <a class="nav-link" href="/logout">Log Out</a>
                        </li>
                        <% } %>
                            <%if (!userinfo) { %>
                                <li class="nav-item" role="presentation">
                                    <a class="nav-link" href="/login">Log In</a>
                                </li>
                                <% } %>
                </ul>
            </div>
        </div>
    </nav>
    <div style="box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19); background: white; padding: 50px; padding-bottom: 15px; margin-left: 5%; margin-right: 5%; margin-top: 15px; margin-bottom: 15px; border-radius: 50px">
        <p id="DoT_Tag">The West Virginia Department of Transportation&nbsp;</p>
        <p id="DoT_Tag2">Divsion of Highways</p>
        <p id="Title">Bridge Inspection Report</p>
        <br>
        <hr>
        <input  type=hidden name=reportID value=<%- rep[0]["reportID"] %>>
        <p id="Bridge_Name">
            <%- rep[0]["name"]%>
        </p>
        <p id="Bridge_Loc">
            <%- rep[0]["location"]%>
        </p>
        <hr>
        <form action="/report" method="post">
        <ul class="allElements">
        <li class="ui-state-default" id="holder1" style="padding: 15px; list-style-type: none;"><span class="ui-icon ui-icon-arrowthick-2-n-s"></span>
            <div  style="padding: 15px">
                <input type="text" placeholder="Header" name="header" style="display: inline-block; width: 94%; margin: auto;">                
                 <button type="button" id="remove1" class="btn btn-primary" id="remover" onclick="remove(this.id)" style="width: 5% ; display: inline-block; margin: auto;">X</button>
            </div>
            <div class="container" style="padding: 0; margin: 0; margin-bottom: 15px; min-width: 100%;">
                <div class="row">
                    <div class="col-lg" style="padding: 15px ;margin: 0;">
                        <textarea placeholder="Enter your comment here" rows="4" cols="50" style="margin-bottom: 15px;margin-right: 0px;height: 350px;width: 100%;display: inline-block;"></textarea>

                    </div>
                    <div class="col-lg" style="padding: 15px ;margin: 0;">
                        <div class="uploader" name="1" >
                            Click here or drag here your image
                            <img id="image1" src="/pictures/Empty.png" />
                            <input class="up"  onclick="myFunction(this.name)" ondrop="myFunction(this.name)" type="file" id="filePhoto1" name="1" style="background: transperent"/>
                        </div>
                    </div>
                </div>
            </div>
        </li>
    </ul>
        <div id="buttonHolder">
                <button type="button" class="btn btn-primary" id="adder" style="width: 40%; display: block; margin: auto;">Add another element</button>
                <br id="removeBreak">
                <input type="submit" class="btn btn-primary" style="width: 40%; display: block; margin: auto;" value="Submit Report">
                </form>
                </div>
        </div>
        
    
    </div>



    
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/bootstrap/js/bootstrap.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

</body>

</html>
<script>
        $('.ui-state-default').mousedown(function(){ $('.container').hide(); })
        $('.allElements').on('mousedown', 'li.ui-state-default', function() {
         $('div.container').hide(); })

    var counter = 1;
    function myFunction(name){
        var imageLoader = document.getElementById("filePhoto"+String(name));
        imageLoader.addEventListener('change', handleImage, false);
        function handleImage(e) {
            var reader = new FileReader();
            reader.onload = function (event) {
                $('#image'+String(name)).attr('src', event.target.result);
            }
            reader.readAsDataURL(e.target.files[0]);
        }
    }
    function remove(id){
        counter = counter - 1;
        var num = id.replace(/\D/g,'');
        $("#holder"+num).remove();
    
    }
   
    $(function() {
        $( ".allElements" ).sortable({
            stop: function(){ $('.container').show(); },
            axis: "y",
            connectWith: '.allElements',
            items: '.ui-state-default',
            placeholder: 'placeholder',
            tolerance: 'pointer',
            });
    });
        $("#adder").click(function () {
            counter++;
            var el = $('<li class="ui-state-default" id="holder'+counter+'" style="padding: 15px; list-style-type: none;"><span class="ui-icon ui-icon-arrowthick-2-n-s"></span><div  style="padding: 15px"><input type="text" placeholder="Header" name="header" style="display: inline-block; width: 94%; margin: auto;"><button type="button" id="remove'+counter+'" class="btn btn-primary" id="remover" onclick="remove(this.id)" style="width: 5% ; display: inline-block; margin: auto;">X</button></div><div class="container" style="padding: 0; margin: 0; margin-bottom: 15px; min-width: 100%;"><div class="row"><div class="col-lg" style="padding: 15px ;margin: 0;"><textarea placeholder="Enter your comment here" rows="4" cols="50" style="margin-bottom: 15px;margin-right: 0px;height: 350px;width: 100%;display: inline-block;"></textarea></div><div class="col-lg" style="padding: 15px ;margin: 0;"><div class="uploader" name="1" >Click here or drag here your image<img id="image'+counter+'" src="/pictures/Empty.png" /><input class="up"  onclick="myFunction(this.name)" ondrop="myFunction(this.name)" type="file" id="filePhoto'+counter+'" name="1" style="background: transperent"/></div></div></div></div></li></ul>')
            //$("#element").append('<input type="text" placeholder="Header" name="header" style="display: block; width: 100%; margin: auto;" required>')
            $(".allElements").append(el);
        });
        /*if(counter == 0){
            removeButton.disabled = true;
            $('#remover').attr('style', "display: none; width: 40%; margin: auto;");
            $('#removeBreak').attr('style', "display: none;")
        } if(counter == 1){
            removeButton.disabled = false;
            $('#remover').attr('style', "width: 40%; display: block; margin: auto;");
            $('#removeBreak').attr('style', "")
        }
        });*/
        
       /* $("#remover").click(function () {
           $("#holder"+String(counter)).remove();         
           counter = counter - 1;           
            var removeButton = document.getElementById('remover')
        if(counter == 0){
            removeButton.disabled = true;
            $('#removeBreak').attr('style', "display: none;")
            $('#remover').attr('style', "display: none; width: 40%; margin: auto;");
        } if(counter == 1){
            removeButton.disabled = false;
            $('#removeBreak').attr('style', "")
            $('#remover').attr('style', "width: 40%; display: block; margin: auto;");
        }
        });*/
</script>